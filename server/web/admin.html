<!doctype html><html lang="uk"><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1"><title>–ê–¥–º—ñ–Ω–∫–∞</title>
<style>
 body{font-family:system-ui,sans-serif;margin:0 auto;max-width:820px;padding:16px}
 input,textarea{width:100%;padding:8px;margin:6px 0 12px;border:1px solid #ddd;border-radius:6px}
 .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
 button{padding:10px 12px;border-radius:8px;border:1px solid #ddd;background:#0ea5e9;color:#fff;cursor:pointer}
 .muted{color:#666;font-size:12px}
</style>
<body>
  <h2>–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</h2>
  <p class="muted">–í–≤–µ–¥–∏ —Å–µ–∫—Ä–µ—Ç –∑ Render (ENV <b>ADMIN_SECRET</b>). –í—ñ–Ω –∑–±–µ—Ä–µ–∂–µ—Ç—å—Å—è —É –±—Ä–∞—É–∑–µ—Ä—ñ.</p>
  <label>Admin Secret</label><input id="sec" placeholder="—Å–µ–∫—Ä–µ—Ç">
<!-- –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞ + –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä + —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ image_url -->

<!-- –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞ + –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä + —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ image_url -->
<div class="field">
  <label>–§–æ—Ç–æ</label>
  <input id="file" type="file" accept="image/*">
  <div style="margin-top:8px;display:flex;gap:12px;align-items:center">
    <button id="btnUpload" type="button">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–æ—Ç–æ</button>
    <img id="preview" style="max-height:80px;border-radius:8px;display:none">
  </div>
  <input id="image_url" placeholder="/uploads/....webp" readonly>
  <div class="hint">–ü—ñ–¥—Ç—Ä–∏–º–∫–∞: WEBP/JPG/PNG, –¥–æ 8MB. –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ ~1200√ó800.</div>
</div>
 <script>
const fileInput = document.getElementById('file');
const btnUpload = document.getElementById('btnUpload');
const imgUrl    = document.getElementById('image_url');
const preview   = document.getElementById('preview');

btnUpload.addEventListener('click', async () => {
  const file = fileInput.files[0];
  if (!file) { alert('–û–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª'); return; }

  const fd = new FormData();
  fd.append('file', file);

  btnUpload.disabled = true;
  btnUpload.textContent = '–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...';

  try {
    const res = await fetch('/api/upload', { method: 'POST', body: fd });
    const data = await res.json();
    if (!res.ok) throw new Error(data.error || 'Upload error');

    imgUrl.value = data.url;     // —Å—é–¥–∞ –∫–ª–∞–¥—ë–º —Å—Å—ã–ª–∫—É
    preview.src = data.url;      // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é
    preview.style.display = '';
  } catch (e) {
    alert(e.message);
  } finally {
    btnUpload.disabled = false;
    btnUpload.textContent = '–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–æ—Ç–æ';
  }
});
</script>


  <hr><h3>–°—Ç–≤–æ—Ä–∏—Ç–∏ / –æ–Ω–æ–≤–∏—Ç–∏ —Ç–æ–≤–∞—Ä</h3>
  <label>SKU</label><input id="sku" placeholder="—É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –∫–æ–¥ (coffee_1kg)">
  <label>–ù–∞–∑–≤–∞</label><input id="title" placeholder="–ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É">
  <div class="row">
    <div><label>–¶—ñ–Ω–∞</label><input id="price" type="number" placeholder="1299"></div>
    <div><label>–í–∞–ª—é—Ç–∞</label><input id="cur" value="UAH"></div>
  </div>
  <label>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label><input id="cat">
  <label>–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è (URL)</label><input id="img" placeholder="https://...">
  <label>–û–ø–∏—Å</label><textarea id="desc" rows="4"></textarea>
  <label><input type="checkbox" id="active" checked> –ê–∫—Ç–∏–≤–Ω–∏–π</label>
  <button id="save">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
<!doctype html><html lang="uk"><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1"><title>–ê–¥–º—ñ–Ω–∫–∞</title>
<style>
  body{font-family:system-ui,sans-serif;margin:0 auto;max-width:820px;padding:16px}
  input,textarea{width:100%;padding:8px;margin:6px 0 12px;border:1px solid #ddd;border-radius:6px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  button{padding:10px 12px;border-radius:8px;border:1px solid #ddd;background:#0ea5e9;color:#fff;cursor:pointer}
  .muted{color:#666;font-size:12px}
</style>
<body>
  <h2>–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</h2>
  <p class="muted">–í–≤–µ–¥–∏ —Å–µ–∫—Ä–µ—Ç –∑ Render (ENV <b>ADMIN_SECRET</b>). –í—ñ–Ω –∑–±–µ—Ä–µ–∂–µ—Ç—å—Å—è —É –±—Ä–∞—É–∑–µ—Ä—ñ.</p>


  <label>Admin Secret</label>
  <input id="sec" placeholder="—Å–µ–∫—Ä–µ—Ç">

  <hr><h3>–°—Ç–≤–æ—Ä–∏—Ç–∏ / –æ–Ω–æ–≤–∏—Ç–∏ —Ç–æ–≤–∞—Ä</h3>
  <label>SKU</label><input id="sku" placeholder="—É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –∫–æ–¥ (coffee_1kg)">
  <label>–ù–∞–∑–≤–∞</label><input id="title" placeholder="–ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É">
  <div class="row">
    <div><label>–¶—ñ–Ω–∞</label><input id="price" type="number" placeholder="1299"></div>
    <div><label>–í–∞–ª—é—Ç–∞</label><input id="cur" value="UAH"></div>
  </div>
  <label>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label><input id="cat">
  <label>–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è (URL)</label><input id="img" placeholder="https://...">
  <label>–û–ø–∏—Å</label><textarea id="desc" rows="4"></textarea>
  <label><input type="checkbox" id="active" checked> –ê–∫—Ç–∏–≤–Ω–∏–π</label>
  <button id="save">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
<button id="del" style="margin-left:8px;background:#ef4444">üóë –í–∏–¥–∞–ª–∏—Ç–∏</button>


<script>
  const sec = document.getElementById('sec');
  sec.value = localStorage.getItem('admin_secret') || '';
  sec.oninput = () => localStorage.setItem('admin_secret', sec.value);

  const $ = id => document.getElementById(id);

  document.getElementById('save').onclick = async () => {
    const payload = {
      sku: $('sku').value.trim(),
      title: $('title').value.trim(),
      price: parseInt($('price').value || '0', 10),
      currency: $('cur').value.trim() || 'UAH',
      category: $('cat').value.trim(),
      image_url: $('img').value.trim(),
      description: $('desc').value.trim(),
      is_active: $('active').checked
    };

    if (!sec.value || !payload.sku || !payload.title || !payload.price) {
      alert('–ó–∞–ø–æ–≤–Ω–∏ SECRET, SKU, –ù–∞–∑–≤—É —ñ –¶—ñ–Ω—É'); return;
    }

    try {
      const res = await fetch('/api/admin/products', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'X-Admin-Secret': sec.value },
        body: JSON.stringify(payload)
      });
      if (!res.ok) {
        const text = await res.text();
        alert('–ü–æ–º–∏–ª–∫–∞: ' + text);
      } else {
        alert('‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–æ');
      }
    } catch (e) {
      alert('–ú–µ—Ä–µ–∂–Ω–∞ –ø–æ–º–∏–ª–∫–∞: ' + e);
    }
  };
</script>
</body></html>

<script>
 const sec = document.getElementById('sec');
 sec.value = localStorage.getItem('admin_secret') || '';
 sec.oninput = () =><script>
  const sec = document.getElementById('sec');
  sec.value = localStorage.getItem('admin_secret') || '';
  sec.oninput = () => localStorage.setItem('admin_secret', sec.value);

  const $ = id => document.getElementById(id);

  document.getElementById('save').onclick = async () => {
    const payload = {
      sku: $('sku').value.trim(),
      title: $('title').value.trim(),
      price: parseInt($('price').value || '0', 10),
      currency: $('cur').value.trim() || 'UAH',
      category: $('cat').value.trim(),
      image_url: $('img').value.trim(),
      description: $('desc').value.trim(),
      is_active: $('active').checked
    };

    if (!sec.value || !payload.sku || !payload.title || !payload.price) {
      alert('–ó–∞–ø–æ–≤–Ω–∏ SECRET, SKU, –ù–∞–∑–≤—É —ñ –¶—ñ–Ω—É'); return;
    }
<script>
  const sec = document.getElementById('sec');
  sec.value = localStorage.getItem('admin_secret') || '';
  sec.oninput = () => localStorage.setItem('admin_secret', sec.value);

  const $ = id => document.getElementById(id);

  document.getElementById('save').onclick = async () => {
    // ... –∫–∞–∫ –±—ã–ª–æ (—Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
  };

  document.getElementById('del').onclick = async () => {
    console.log('DEL clicked'); // ‚Üê –ø—Ä–æ–≤–µ—Ä—å –≤ Console, –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å—Ç—Ä–æ–∫–∞
    const s = $('sku').value.trim();
    if (!sec.value || !s) { alert('–í–∫–∞–∂–∏ SECRET —ñ SKU'); return; }

    try {
      const r = await fetch('/api/admin/products/delete', {
        method: 'POST',
        headers: {'Content-Type':'application/json','X-Admin-Secret': sec.value},
        body: JSON.stringify({sku: s})
      });
      const txt = await r.text();
      console.log('DEL resp:', r.status, txt);
      if (!r.ok) alert('–ü–æ–º–∏–ª–∫–∞: ' + txt);
      else alert('üóë –í–∏–¥–∞–ª–µ–Ω–æ: ' + s);
    } catch (e) {
      alert('–ú–µ—Ä–µ–∂–Ω–∞ –ø–æ–º–∏–ª–∫–∞: ' + e);
    }
  };
</script>

    const res = await fetch('/api/admin/products', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-Admin-Secret': sec.value
      },
      body: JSON.stringify(payload)
    });

    if (!res.ok) {
      alert('–ü–æ–º–∏–ª–∫–∞: ' + (await res.text()));
    } else {
      alert('‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–æ');
    }
  };
</script>


   









